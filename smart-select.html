<link rel="import" href="../polymer/polymer.html">
<dom-module id="smart-select">
  <template>
    <style>
      :host {
        display: inline-block;
        position: relative;
      }

      :host::before {
        content: '';
        display: none;
        position: fixed;
        top: 0; left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 1;
        background-color: rgba(0,0,0,0.4);
      }

      .smart-select__selected {
        display: block;
        border: 1px solid #000;
        border-radius: 4px;
        padding: 5px 10px;
        position: relative;
        z-index: 0;
        cursor: pointer;
      }

      .smart-select__choices {
        position: fixed;
        display: none;
        z-index: 2;
        flex-direction: column;
        width: 50vw;
        top: 50%; left: 50%;
        transform: translate3d(-50%, -50%, 0);
        background-color: #fff;
      }

      .smart-select__choices span {
        padding: 5px 10px;
        transition: background-color .4s;
        cursor: pointer;
      }

      .smart-select__choices span:hover {
        background-color: rgba(0,0,0,.1);
      }

      :host[opened]::before {
        display: block;
      }

      :host[opened] .smart-select__choices {
        display: flex;
      }

    </style>
    <span class="smart-select__selected">[[ selected.label ]]</span>
    <section class="smart-select__choices">
      <template is="dom-repeat" items="{{choices}}"><span on-click="select" item="{{item}}">{{item.label}}</span></template>
    </section>
  </template>
</dom-module>
<script>
  Polymer({
    is: 'smart-select',
    properties: {
      opened: {
        type: Boolean,
        value: false,
        notify: true,
        reflectToAttribute: true
      },
      choices: {
        type: Array,
        value: []
      },
      selected: {
        value: {
          'value': '-',
          'label': 'Pick a value in the list'
        },
        readOnly: true
      }
    },
    listeners: {
      'click': 'open'
    },
    open: function() {
      this.opened = !this.opened;
    },
    select: function(evt, detail) {
      this.selected = evt.target.item;
      this.fire('select', evt.target.item);
    }
  });
</script>